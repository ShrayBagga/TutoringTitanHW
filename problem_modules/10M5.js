// --- Helper Functions ---
function getRandomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
function formatAnswer(val, p=1) { return parseFloat(val.toFixed(p)).toString().replace(/\.0$/, ''); }

const problemGenerators = [
    () => { const s1 = getRandomInt(3, 7); const s2 = getRandomInt(4, 8); const s3 = s1 + s2 - getRandomInt(1, Math.min(s1, s2)-1); return { problem: `Can the side lengths \\(${s1}, ${s2}, ${s3}\\) form a triangle? (1=yes, 0=no)`, answer: `1`, checkAnswer: "1" }; },
    () => { const s1 = getRandomInt(3, 7); const s2 = getRandomInt(4, 8); const s3 = s1 + s2 + getRandomInt(1, 5); return { problem: `Can the side lengths \\(${s1}, ${s2}, ${s3}\\) form a triangle? (1=yes, 0=no)`, answer: `0`, checkAnswer: "0" }; },
    () => { const s1 = getRandomInt(5, 10); const s2 = getRandomInt(6, 12); const min = s2 - s1; const max = s1 + s2; return { problem: `Two sides of a triangle have lengths \\(${s1}\\) and \\(${s2}\\). The third side must be greater than what number?`, answer: `\\(${min}\\)`, checkAnswer: min.toString() }; },
    () => { const s1 = getRandomInt(5, 10); const s2 = getRandomInt(6, 12); const min = s2 - s1; const max = s1 + s2; return { problem: `Two sides of a triangle have lengths \\(${s1}\\) and \\(${s2}\\). The third side must be less than what number?`, answer: `\\(${max}\\)`, checkAnswer: max.toString() }; },
    () => { const s_sm = getRandomInt(4,6), s_md=getRandomInt(7,9), s_lg=getRandomInt(10,12); return { problem: `A triangle has side lengths \\(${s_sm}, ${s_md}, ${s_lg}\\). Which angle is the largest? (A is opposite ${s_sm}, B opposite ${s_md}, C opposite ${s_lg})`, answer: `\\(\\angle C\\)`, checkAnswer: "C" }; },
    () => { const s_sm = getRandomInt(4,6), s_md=getRandomInt(7,9), s_lg=getRandomInt(10,12); return { problem: `A triangle has side lengths \\(${s_sm}, ${s_md}, ${s_lg}\\). Which angle is the smallest? (A is opposite ${s_sm}, B opposite ${s_md}, C opposite ${s_lg})`, answer: `\\(\\angle A\\)`, checkAnswer: "A" }; },
    () => { const a_sm = getRandomInt(30,50), a_md=getRandomInt(60,70), a_lg=180-a_sm-a_md; return { problem: `A triangle has angles \\(${a_sm}^{\\circ}, ${a_md}^{\\circ}, ${a_lg}^{\\circ}\\). Which side is the longest? (a is opposite ${a_sm}, b opposite ${a_md}, c opposite ${a_lg})`, answer: `side c`, checkAnswer: "c" }; },
    () => { const a_sm = getRandomInt(30,50), a_md=getRandomInt(60,70), a_lg=180-a_sm-a_md; return { problem: `A triangle has angles \\(${a_sm}^{\\circ}, ${a_md}^{\\circ}, ${a_lg}^{\\circ}\\). Which side is the shortest? (a is opposite ${a_sm}, b opposite ${a_md}, c opposite ${a_lg})`, answer: `side a`, checkAnswer: "a" }; },
    () => { const base = getRandomInt(8, 14) * 2; const midsegment = base / 2; const graphId=`g-${Date.now()}`; return { problem: `In \\(\\triangle ABC\\), D is the midpoint of AB and E is the midpoint of AC. If \\(BC = ${base}\\), what is the length of the midsegment DE?`, answer: `\\(${midsegment}\\)`, checkAnswer: midsegment.toString(), graphId, graphFunction:{} }; },
    () => { const midsegment = getRandomInt(5, 10); const base = midsegment * 2; const graphId=`g-${Date.now()}`; return { problem: `The midsegment of a triangle is \\(${midsegment}\\) cm long. What is the length of the third side it is parallel to?`, answer: `\\(${base}\\) cm`, checkAnswer: base.toString(), graphId, graphFunction:{} }; },
    () => { const angle1 = getRandomInt(50, 80); const angle2 = getRandomInt(angle1 + 10, 100); const s1 = 10; const s2 = 10; const graphId=`g-${Date.now()}`; return { problem: `Two triangles each have two sides of length ${s1}. In the first triangle, the included angle is \\(${angle1}^{\\circ}\\). In the second, it is \\(${angle2}^{\\circ}\\). Which triangle has a longer third side? (1=first, 2=second)`, answer: `2`, checkAnswer: "2", hint:"Hinge Theorem", graphId, graphFunction:{} }; },
    () => { const s3_1 = getRandomInt(6, 9); const s3_2 = getRandomInt(s3_1 + 2, 15); const s1 = 12; const s2 = 12; const graphId=`g-${Date.now()}`; return { problem: `Two triangles have two sides of length ${s1}. The third side of the first triangle is ${s3_1}, and the third side of the second is ${s3_2}. Which triangle has a larger included angle between the sides of length ${s1}? (1=first, 2=second)`, answer: `2`, checkAnswer: "2", hint:"Converse of Hinge Theorem", graphId, graphFunction:{} }; },
    () => { const x = getRandomInt(3, 6); const seg1 = 2*x; const seg2 = x+3; return { problem: `A perpendicular bisector divides a segment into two parts measuring \\(${seg1}\\) and \\(x+3\\). Find the value of x.`, answer: `3`, checkAnswer: "3" }; },
    () => { const x = getRandomInt(10, 20); const angle1 = 2*x+5; const angle2 = 3*x-5; return { problem: `An angle bisector divides an angle into two angles measuring \\((2x+5)^{\\circ}\\) and \\((3x-5)^{\\circ}\\). What is the measure of the full angle?`, answer: `\\(50^{\\circ}\\)`, checkAnswer: "50" }; },
    () => { const full_median = getRandomInt(5, 9) * 3; const long_part = full_median * (2/3); return { problem: `The centroid of a triangle is on a median of length \\(${full_median}\\). What is the length from the vertex to the centroid?`, answer: `\\(${long_part}\\)`, checkAnswer: long_part.toString() }; },
    () => { const short_part = getRandomInt(4, 8); const full_median = short_part * 3; return { problem: `The distance from the centroid to the midpoint of a side is \\(${short_part}\\). What is the full length of that median?`, answer: `\\(${full_median}\\)`, checkAnswer: full_median.toString() }; },
    () => { const x1=0,y1=0, x2=getRandomInt(6,10), y2=0, x3=getRandomInt(2,4), y3=getRandomInt(4,8); const midX=(x2+x3)/2, midY=y3/2; const centroidX = (x1+x2+x3)/3; const centroidY = (y1+y2+y3)/3; const graphId=`g-${Date.now()}`; return { problem: `A triangle has vertices at (0,0), (${x2},0), and (${x3},${y3}). What are the coordinates of the centroid?`, answer: `(\\( ${formatAnswer(centroidX)}, ${formatAnswer(centroidY)} \\))`, checkAnswer: `${formatAnswer(centroidX)},${formatAnswer(centroidY)}`, graphId, graphFunction:{} }; },
    () => { const graphId=`g-${Date.now()}`; return { problem: `The point where the three medians of a triangle intersect is called the _____. (Enter a number: 1=centroid, 2=incenter, 3=circumcenter)`, answer: `1`, checkAnswer: "1", graphId, graphFunction:{} }; },
    () => { const graphId=`g-${Date.now()}`; return { problem: `The point where the three angle bisectors of a triangle intersect is the _____. (Enter a number: 1=centroid, 2=incenter, 3=circumcenter)`, answer: `2`, checkAnswer: "2", graphId, graphFunction:{} }; },
    () => { const graphId=`g-${Date.now()}`; return { problem: `The point equidistant from the three vertices of a triangle is the _____. (Enter a number: 1=centroid, 2=incenter, 3=circumcenter)`, answer: `3`, checkAnswer: "3", graphId, graphFunction:{} }; },
];
function generate(settings) {
    const generator = problemGenerators[getRandomInt(0, problemGenerators.length - 1)];
    return { ...generator(), hint: generator().hint || "The largest angle is opposite the longest side. The sum of any two sides must be greater than the third side." };
}
export const module = { topicId: '10M5', topicName: 'Relationships in Triangles', generateProblem: generate };

